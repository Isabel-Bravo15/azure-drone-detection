#!/bin/bash
# Azure Startup Script

echo "========================================"
echo "Drone Detection - Azure Deployment"
echo "========================================"

# Descargar el modelo si no existe
if [ ! -f "best.pt" ]; then
    echo "üì• Descargando modelo best.pt..."
    # Reemplaza con tu URL real de descarga
    wget -O best.pt "https://huggingface.co/doguilmak/Drone-Detection-YOLOv11x/resolve/main/weight/best.pt"
    
    if [ $? -eq 0 ]; then
        echo "‚úÖ Modelo descargado exitosamente"
    else
        echo "‚ùå Error al descargar el modelo"
        exit 1
    fi
else
    echo "‚úÖ Modelo best.pt ya existe"
fi

# Activar entorno virtual (Azure lo maneja autom√°ticamente)
# source venv/bin/activate

# Instalar dependencias optimizadas para Azure
pip install --upgrade pip
pip install -r requirements_azure.txt

# Ejecutar servidor (SIN SSL, Azure maneja eso)
echo "üöÄ Starting Azure-optimized server..."
python app_azure.py --host 0.0.0.0 --port 8000